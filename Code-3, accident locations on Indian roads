import csv

from geopy.geocoders import Nominatim





# calling the Nominatim tool

loc = Nominatim(user_agent="GetLoc")



# Open file

#csv.writer("black_spots_data.csv", dialect='excel', **fmtparams)



file_out = "black_spots_data.csv"

with open (file_out,'w',newline='') as csvfile:

    csvwriter = csv.writer(csvfile)

    with open('black_spots.csv') as file_obj:

      

         #  heading = next(file_obj)

   

    # Create reader object by passing the file 

    # object to reader method

           reader_obj = csv.reader(file_obj)

      

    # Iterate over each row in the csv file 

    # using reader object

           for row in reader_obj:

               if row[1] == 'do':

                  row[1] = prev_dist

               prev_dist = row[1]

               if row[2] == 'do':

                  row[2] = prev_juridiction  

               prev_juridiction = row[2]

             

               if row == 1: break

               if row[2] == " ": break

               print ("column 2 :",row[2])

              # location_text = row[1]+" "+row[2]

               location_text = row[1].rjust(10)

                

               print ("Location",location_text)

               print (Error_msg)

            

               getLocation = loc.geocode(location_text) 

               get_latitude = getLocation.latitude

               get_longitude = getLocation.longitude

               print("Latitude = ", get_latitude,"\n")

               print("Longitude = ", get_longitude)

               if ValueError: 

                   print ("NBTEST")

                   Error_msg1 = 1

                                     

               if Error_msg1 != 1:   

                     print ("*******")

                     Error_msg1 = 0

                     get_latitude = getLocation.latitude

                     get_longitude = getLocation.longitude

                     print("Latitude = ", get_latitude,"\n")

                     print("Longitude = ", get_longitude)

                     csvwriter.writerow(row)

               Error_msg1 = 0

                # printing address

              # print(getLoc.address)

 

# printing latitude and longitude

                    

               #csvwriter.writerow(row)

             #  print(row)

        

